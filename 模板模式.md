#### 模板模式

模板模式主要用来解决复用和扩展两个问题。

模板方法模式在一个方法中定义一个算法骨架，并将某些步骤推迟到子类中实现。模板方法模式可以让子类在不改变算法整体结构的情况下，重新定义算法中的某些步骤。


模板模式把一个算法中不变的流程抽象到父类的模板方法 templateMethod() 中， 将可变的部分 method1()、method2() 留给子类 ContreteClass1 和 ContreteClass2 来实现。所有的子类的都可以复用父类中模板方法定义的流程代码。


模板模式有两大作用：复用和扩展。

其中，复用指的是，所有的子类可以复用父类中提供的模板方法的代码。

扩展指的是，框架通过模板模式提供功能扩展点，让框架用户可以在不修改框架源码的情况下，基于扩展点定制化框架的功能。





#### 回调

复用和扩展是模板模式的两大作用，回调也能起到相同的作用。


##### 回调的原理解析

相对于普通的函数调用来说，回调是一种双向调用关系。

A 类事先注册某个函数 f 到 B 类中, A 类在调用 B 类的 p 函数的时候，B 类反过来调用 A 类注册给它的 f 函数。 这里的 f 函数就是 “回调函数”。

A 调用 B，B 反过来又调用 A，这种调用机制就叫做 “回调”。

A 类如何将回调函数传递给 B 类呢？不同的编程语言，有不同的实现方法。C 语言可以使用函数指针，Java 则需要使用包裹了回调函数的类对象，我们简称回调对象。


##### 回调的实现


##### 回调的应用

例如：

1. JdbcTemplate

2. setClickListener()

3. addShutdownHook()




#### 模板模式、回调

从应用场景来看，同步回调跟模板模式几乎一致。它们都是在一个大的算法骨架中，自由替换其中的某个步骤，起到代码复用和扩展的目的。
而异步回调跟模板模式有较大差别，更像是观察者模式。

从代码实现上来看，回调和模板模式完全不同。回调基于组合关系来实现，把一个对象传递给另一个对象，是一种对象之间的关系；模板模式基于继承关系来实现，子类重写父类的抽象方法，是一种类之间的关系。

组合优于继承。在代码实现上，回调相对于模板模式会更加灵活，主要体现在下面几点。

* 像 Java 这种只支持单继承的语言，基于模板模式编写的子类，已经继承了一个父类，不再具有继承的能力。 

* 回调可以使用匿名类来创建回调对象，可以不用事先定义类；而模板模式针对不同的实现都要定义不同的子类。

* 如果某个类中定义了多个模板方法，每个方法都有应对的抽象方法，那即便我们只用到其中的一个模板方法，子类也必须实现所有的抽象方法。而回调就更加灵活，我们只需要往用到的模板方法中注入回调对象即可。








